<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <title>Calendario dell'Avvento â€“ Classico</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <style>
    :root{
      --card-radius: 18px;
      --shadow-soft: 0 10px 25px rgba(15, 23, 42, 0.18);
      --accent: #f97316;
      --lock-bg: rgba(15,23,42,0.65);
    }

    * {
      box-sizing: border-box;
    }

    /* Sfondo base */
    body::before {
      content: "";
      position: fixed;
      inset: 0;
      background: url("img/sfondo_1.jpg") center/cover no-repeat fixed;
      z-index: -2;
      opacity: 1;
      transition: opacity 0.8s ease;
    }

    /* Sfondo 2 (switch al giorno 10) */
    body::after {
      content: "";
      position: fixed;
      inset: 0;
      background: url("img/sfondo_2.jpg") center/cover no-repeat fixed;
      z-index: -1;
      opacity: 0;
      transition: opacity 0.8s ease;
    }

    body.bg-2::before { opacity: 0; }
    body.bg-2::after { opacity: 1; }

    body {
      margin:0;
      min-height:100vh;
      font-family: system-ui, sans-serif;
      color:#111827;
      display:flex;
      justify-content:center;
      padding:24px 12px 40px;
    }

    .page-container{
      max-width:1100px;
      width:100%;
      border-radius:24px;
      padding:24px 16px 32px;
    }

    /* ========== GRID ========== */
    .calendar-grid{
      display:grid;
      grid-template-columns: repeat(5, minmax(0, 1fr));
      justify-content:center;
      gap:18px;
      padding:8px;
    }

    .box-wrapper{
      display:flex;
      justify-content:center;
    }

    .day-box{
      position:relative;
      width:150px;
      height:150px;
      border-radius:18px;
      overflow:hidden;
      background:#ffffff;
      box-shadow:0 10px 25px rgba(15, 23, 42, 0.18);
      cursor:pointer;
      transition: transform .2s ease, box-shadow .2s ease;
      border:4px solid #ffffff;
    }

    .day-box img{
      width:100%;
      height:100%;
      object-fit:cover;
      display:block;
    }

    .day-box:hover{
      transform: translateY(-2px);
      box-shadow:0 16px 30px rgba(15,23,42,0.22);
    }

    .day-box:hover img{
      transform:scale(1.03);
    }

    /* ========== BLOCCATI ========== */
    .day-box-locked {
      cursor:not-allowed;
    }

    .day-box-locked img{
      filter: blur(3px) brightness(0.92);
    }

    /* ========== BADGE NUMERO ========== */
    .day-badge{
      position:absolute;
      top:8px;
      left:8px;
      width:32px;
      height:32px;
      background:#ffffffcc;
      border-radius:50%;
      display:flex;
      align-items:center;
      justify-content:center;
      font-weight:700;
      font-size:15px;
      color:#111;
      backdrop-filter: blur(5px);
      box-shadow:0 2px 6px rgba(0,0,0,0.25);
      z-index:3;
    }

    /* ========== BADGE NEW (giorno corrente) ========== */
    .day-new-badge {
      position: absolute;
      top: 6px;
      right: 6px;
      background: #facc15;
      color: #111;
      font-weight: 700;
      font-size: 12px;
      padding: 3px 7px;
      border-radius: 10px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.25);
      z-index: 3;
      animation: new-badge-pulse 1.4s infinite ease-in-out;
    }

    @keyframes new-badge-pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.15); }
      100% { transform: scale(1); }
    }

    /* ========== ANIMAZIONI ========== */
    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      20%, 60% { transform: translateX(-4px); }
      40%, 80% { transform: translateX(4px); }
    }

    .day-box.shake {
      animation: shake 0.35s;
    }

    @keyframes box-break {
      0% { transform: scale(1); }
      100% { transform: scale(1.05); }
    }

    .day-box.breaking {
      animation: box-break 0.35s;
    }

    /* ========== POPUP ========== */
    .popup{
      display:none;
      position:fixed;
      inset:0;
      background:rgba(15,23,42,0.85);
      justify-content:center;
      align-items:center;
      padding:20px;
      z-index:9999;
    }

    .popup-content{
      background:#ffffffee;
      border-radius:22px;
      max-width:420px;
      width:100%;
      padding:22px 20px 20px;
      position:relative;
      text-align:center;
    }

    .popup-content img{
      width:100%;
      height:auto;
      border-radius:16px;
      margin-bottom:14px;
    }

    .popup-close{
      position:absolute;
      top:10px;
      right:14px;
      font-size:26px;
      cursor:pointer;
      color:#333;
    }

    .popup-close:hover{
      color:#000;
    }

    .cta-button{
      display:inline-block;
      padding:10px 18px;
      border-radius:999px;
      color:#fff;
      background:var(--accent);
      font-weight:600;
      text-decoration:none;
    }

    /* ========== RESPONSIVE ========== */
    @media (max-width: 900px){
      .calendar-grid{
        grid-template-columns: repeat(4, minmax(0, 1fr));
      }
    }

    @media (max-width: 600px){
      .calendar-grid{
        grid-template-columns: repeat(3, minmax(0, 1fr));
      }
      .day-box{
        width:100px;
        height:100px;
      }
    }

    @media (max-width: 400px){
      .day-box{
        width:90px;
        height:90px;
      }
    }
  </style>
</head>
<body>

  <div class="page-container">
    <div id="calendar" class="calendar-grid"></div>
  </div>

  <script>
    /* ======= GIORNI ======= */
    const days = [
      { day: 1, imgSmall: 'img/DEC_1.jpg', imgBig: 'img/1_BIG.png', title: 'Giorno 1', text:'Testo...', link:'#', ctaLabel:'Scopri', ctaColor:'#ec4899', unlockDate:'2025-12-01' },
      { day: 2, imgSmall: 'img/DEC_2.jpg', imgBig: 'img/2_BIG.jpg', title:'Giorno 2', text:'Testo...', link:'#', ctaLabel:'Scopri', ctaColor:'#0ea5e9', unlockDate:'2025-12-02' },
      { day: 3, imgSmall: 'img/DEC_3.jpg', imgBig: 'img/3_BIG.jpg', title:'Giorno 3', text:'Testo...', link:'#', ctaLabel:'Scopri', ctaColor:'#22c55e', unlockDate:'2025-12-03' },
      { day: 4, imgSmall: 'img/DEC_4.jpg', imgBig: 'img/4_BIG.jpg', title:'Giorno 4', text:'Testo...', link:'#', ctaLabel:'Scopri', ctaColor:'#f97316', unlockDate:'2025-12-04' },
      { day: 5, imgSmall: 'img/DEC_5.jpg', imgBig: 'img/5_BIG.jpg', title:'Giorno 5', text:'Testo...', link:'#', ctaLabel:'Scopri', ctaColor:'#e11d48', unlockDate:'2025-12-05' },

      /* â€¦ CONTINUA FINO AL 25 â€¦ */

      { day: 25, imgSmall: 'img/DEC_25.jpg', imgBig: 'img/25_BIG.jpg', title:'Giorno 25', text:'ðŸŽ', link:'#', ctaLabel:'Apri regalo', ctaColor:'#e11d48', unlockDate:'2025-12-25' }
    ];


    /* ======= UTIL ======= */
    function normalizeDate(d){
      const x = new Date(d);
      x.setHours(0,0,0,0);
      return x;
    }

    const today = normalizeDate(new Date());

    function isFuture(d){
      return normalizeDate(d) > today;
    }
    function isToday(d){
      return normalizeDate(d).getTime() === today.getTime();
    }

    /* ======= POPUP ======= */
    function openPopup(id){
      document.getElementById(id).style.display = "flex";
    }

    function closePopup(el){
      el.style.display = "none";
    }

    /* ======= CREA BOX ======= */
    function createDayBox(day){
      const future = isFuture(day.unlockDate);
      const todayDay = isToday(day.unlockDate);

      const wrapper = document.createElement('div');
      wrapper.className = "box-wrapper";

      const box = document.createElement('div');
      box.className = "day-box";

      if(future || todayDay) box.classList.add("day-box-locked");

      const img = document.createElement('img');
      img.src = day.imgSmall;
      img.alt = day.title;
      box.appendChild(img);

      const num = document.createElement('div');
      num.className = "day-badge";
      num.textContent = day.day;
      box.appendChild(num);

      if(todayDay){
        const newTag = document.createElement('div');
        newTag.className = "day-new-badge";
        newTag.textContent = "NEW";
        box.appendChild(newTag);
      }

      if(future){
        box.addEventListener('click', () => {
          box.classList.add('shake');
          setTimeout(()=>box.classList.remove('shake'), 350);
        });
      } else if(todayDay){
        box.addEventListener('click', () => {
          box.classList.add('breaking');
          setTimeout(()=>{
            box.classList.remove('day-box-locked');
            box.classList.remove('breaking');
            openPopup("popup"+day.day);

            if(day.day === 10){
              document.body.classList.add("bg-2");
            }
          }, 350);
        });
      } else {
        box.addEventListener('click', () => {
          openPopup("popup"+day.day);
          if(day.day === 10){
            document.body.classList.add("bg-2");
          }
        });
      }

      wrapper.appendChild(box);
      return wrapper;
    }

    /* ======= POPUP CREATOR ======= */
    function createPopup(day){
      const popup = document.createElement('div');
      popup.className = "popup";
      popup.id = "popup"+day.day;
      popup.onclick = function(){ closePopup(popup); };

      const content = document.createElement('div');
      content.className = "popup-content";
      content.onclick = (e)=>e.stopPropagation();

      const close = document.createElement('div');
      close.className = "popup-close";
      close.innerHTML = "&times;";
      close.onclick = (e)=>{ e.stopPropagation(); popup.style.display="none"; };

      const img = document.createElement('img');
      img.src = day.imgBig;

      const title = document.createElement('h3');
      title.textContent = day.title;

      const p = document.createElement('p');
      p.textContent = day.text;

      const btn = document.createElement('a');
      btn.className = "cta-button";
      btn.href = day.link;
      btn.target = "_blank";
      btn.style.background = day.ctaColor;
      btn.textContent = day.ctaLabel;

      content.appendChild(close);
      content.appendChild(img);
      content.appendChild(title);
      content.appendChild(p);
      content.appendChild(btn);
      popup.appendChild(content);

      document.body.appendChild(popup);
    }

    /* ======= RENDER ======= */
    function renderCalendar(){
      const grid = document.getElementById('calendar');
      days.forEach(day => {
        grid.appendChild(createDayBox(day));
        createPopup(day);
      });
    }

    renderCalendar();
  </script>

</body>
</html>
